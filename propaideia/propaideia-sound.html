<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Προπαίδεια — Παιχνίδι με Μουσική</title>
  <style>
    :root{
      --bg:#0b1220; --card:#071428; --accent:#ffb703; --text:#e6eef8;
      --btn:#083b66; --btn-hover:#0b57a4;
      --correct:#16a34a; --wrong:#ef4444;
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#051025,#07142a);color:var(--text);display:flex;align-items:center;justify-content:center;padding:20px}
    .card{width:100%;max-width:720px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);border-radius:12px;padding:18px;box-shadow:0 10px 40px rgba(2,6,23,0.7)}
    h1{margin:0 0 8px 0;font-size:22px;color:var(--accent)}
    .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px;flex-wrap:wrap}
    .status{display:flex;gap:12px;align-items:center}
    .pill{background:rgba(255,255,255,0.02);padding:8px 12px;border-radius:10px;font-weight:700}
    #questionBox{margin:12px 0;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:10px;text-align:center}
    #question{font-size:44px;font-weight:800;letter-spacing:1px;margin:0}
    .answers{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:16px}
    .btn{background:var(--btn);border:1px solid rgba(255,255,255,0.03);color:var(--text);padding:14px;border-radius:10px;font-size:18px;cursor:pointer;transition:transform .08s,box-shadow .12s}
    .btn:hover{background:var(--btn-hover);transform:translateY(-2px)}
    .controls{display:flex;gap:8px;justify-content:flex-end;margin-top:14px;flex-wrap:wrap}
    .small{font-size:13px;opacity:0.9}
    .feedback{height:44px;display:flex;align-items:center;gap:10px;padding:0 6px;color:#dff7e1}
    .muted{opacity:0.6}
    footer{margin-top:12px;font-size:13px;color:rgba(230,238,248,0.7);text-align:center}
    @media(max-width:520px){ #question{font-size:36px} .btn{font-size:16px;padding:12px} .answers{grid-template-columns:1fr} }
    /* small accessibility focus */
    .btn:focus{outline:3px solid rgba(255,183,3,0.18);outline-offset:3px}
  </style>
</head>
<body>
  <div class="card" role="application" aria-label="Παιχνίδι εκμάθησης προπαίδειας">
    <h1>Μάθε την Προπαίδεια 🎵🎯</h1>

    <div class="topbar">
      <div class="status">
        <div class="pill">Σκορ: <span id="score">0</span></div>
        <div class="pill">Highscore: <span id="highscore">0</span></div>
      </div>
      <div class="small">Πάτησε τη σωστή απάντηση — σωστό: +10, λάθος: −5</div>
    </div>

    <div id="questionBox" aria-live="polite">
      <p id="question">— × — = ?</p>
      <div class="answers" role="list">
        <button class="btn" data-ans idx="0" aria-label="Απάντηση 1"></button>
        <button class="btn" data-ans idx="1" aria-label="Απάντηση 2"></button>
        <button class="btn" data-ans idx="2" aria-label="Απάντηση 3"></button>
        <button class="btn" data-ans idx="3" aria-label="Απάντηση 4"></button>
      </div>
    </div>

    <div class="feedback">
      <div id="msg" class="small">Κάνε κλικ σε μία απάντηση για να ακούσεις σωστό/λάθος.</div>
    </div>

    <div class="controls">
      <button id="nextBtn" class="btn" title="Νέα ερώτηση">Νέα</button>
      <button id="resetHigh" class="btn" title="Διαγραφή υψηλού σκορ">Επαναφ. Highscore</button>
      <button id="muteBtn" class="btn" title="Σίγαση / Ήχος">Σίγαση</button>
    </div>

    <footer>Προπαίδεια 1–10 · Μουσική φόντου παιγνιδιάρικη · Ήχοι από Pixabay και Mixkit</footer>
  </div>

  <!-- Μουσική & ήχοι (Mixkit - δωρεάν previews) -->
  <!-- Παιχνιδιάρικη / χαρούμενη μουσική -->
  <audio id="bgMusic" src="background.mp3" preload="auto" loop></audio>

  <!-- Ήχος σωστής απάντησης -->
  <audio id="sfxCorrect" src="correct-answer.mp3" preload="auto"></audio>

  <!-- Ήχος λάθους -->
  <audio id="sfxWrong" src="wrong-answer.mp3" preload="auto"></audio>

<script>
// --- Παιχνίδι προπαίδειας με συνεχή μουσική φόντου και ήχους ---
const questionEl = document.getElementById('question');
const answerBtns = Array.from(document.querySelectorAll('.answers .btn'));
const scoreEl = document.getElementById('score');
const highEl = document.getElementById('highscore');
const msgEl = document.getElementById('msg');
const nextBtn = document.getElementById('nextBtn');
const resetBtn = document.getElementById('resetHigh');
const muteBtn = document.getElementById('muteBtn');

const bgMusic = document.getElementById('bgMusic');
const sfxCorrect = document.getElementById('sfxCorrect');
const sfxWrong = document.getElementById('sfxWrong');

let score = 0;
let highscore = parseInt(localStorage.getItem('praidia_highscore') || '0', 10);
let current = {a:1,b:1,ans:1};
let muted = false;

highEl.textContent = highscore;
scoreEl.textContent = score;

// βοηθητικές συναρτήσεις
function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

// Δημιουργεί ερώτηση (1..10 × 1..10)
function makeQuestion() {
  const a = randInt(1,10);
  const b = randInt(1,10);
  const ans = a*b;
  current = {a,b,ans};
  questionEl.textContent = `${a} × ${b} = ?`;
  // φτιάξε 3 λάθος επιλογές κοντά στην σωστή (μη επαναλαμβανόμενες)
  const choices = new Set([ans]);
  while(choices.size < 4){
    // παράγουμε παρόμοιες τιμές με μικρή απόκλιση
    let delta = Math.round(ans * (Math.random()*0.5 - 0.25));
    if(Math.abs(delta) < 2) delta += (Math.random() < 0.5 ? -2 : 2);
    let cand = ans + delta;
    if(cand < 1) cand = Math.abs(cand) + 1;
    choices.add(cand);
  }
  // shuffle
  const arr = Array.from(choices);
  for(let i=arr.length-1;i>0;i--){ const j = Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
  for(let i=0;i<4;i++){
    answerBtns[i].textContent = arr[i];
    answerBtns[i].dataset.value = arr[i];
    answerBtns[i].disabled = false;
    answerBtns[i].style.background = '';
    answerBtns[i].style.outline = '';
  }
  msgEl.textContent = 'Επίλεξε απάντηση';
}

// Χειρισμός απάντησης
function onAnswerClick(e){
  const btn = e.currentTarget;
  const val = Number(btn.dataset.value);
  // μπλοκάρισμα κουμπιών
  answerBtns.forEach(b => b.disabled = true);
  if(val === current.ans){
    // σωστό
    score += 10;
    msgEl.textContent = 'Σωστά! +10';
    btn.style.background = 'linear-gradient(90deg, rgba(22,163,74,0.18), rgba(22,163,74,0.06))';
    playSFX(sfxCorrect);
  } else {
    // λάθος
    score = Math.max(0, score - 5);
    msgEl.textContent = `Λάθος — σωστή: ${current.ans}  (−5)`;
    btn.style.background = 'linear-gradient(90deg, rgba(239,68,68,0.14), rgba(239,68,68,0.06))';
    // επισημαίνουμε σωστή απάντηση
    answerBtns.forEach(b => {
      if(Number(b.dataset.value) === current.ans) b.style.outline = '3px solid rgba(22,163,74,0.65)';
    });
    playSFX(sfxWrong);
  }
  updateScoreUI();
  // μετά από 900ms νέα ερώτηση
  setTimeout(()=>{ makeQuestion(); }, 900);
}

// Ενημέρωση σκορ & highscore
function updateScoreUI(){
  scoreEl.textContent = score;
  if(score > highscore){
    highscore = score;
    highEl.textContent = highscore;
    localStorage.setItem('praidia_highscore', String(highscore));
  }
}

// Ήχοι
function playSFX(audio){
  if(muted) return;
  try{ audio.currentTime = 0; audio.play(); } catch(e){}
}

// Κουμπιά
nextBtn.addEventListener('click', ()=>{ makeQuestion(); });
resetBtn.addEventListener('click', ()=>{
  if(confirm('Είσαι σίγουρος/η ότι θέλεις να διαγράψεις το highscore;')){
    localStorage.removeItem('praidia_highscore');
    highscore = 0; highEl.textContent = '0';
  }
});
muteBtn.addEventListener('click', ()=>{
  muted = !muted;
  muteBtn.textContent = muted ? 'Ήχος' : 'Σίγαση';
  bgMusic.muted = muted;
});

// Συνδέουμε κουμπιά απαντήσεων
answerBtns.forEach(b => b.addEventListener('click', onAnswerClick));

// Αυτόματη εκκίνηση
makeQuestion();

// Προσπάθεια να παίξει μουσική (autoplay may be blocked — κάνουμε fallback στο πρώτο κλικ)
bgMusic.volume = 0.2;
bgMusic.loop = true;
bgMusic.play().catch(()=>{ 
  // αν μπλοκάρει, θα ξεκινήσει με το πρώτο user gesture
  msgEl.textContent = 'Κάνε κλικ οπουδήποτε για να ξεκινήσει η μουσική 🎵';
  function startOnFirstClick() {
    bgMusic.play().catch(()=>{});
    document.removeEventListener('click', startOnFirstClick);
    msgEl.textContent = 'Επίλεξε απάντηση';
  }
  document.addEventListener('click', startOnFirstClick);
});

// Προσθέτουμε μικρό ηχητικό ξεκλίκ (παίζει μόνο στο πρώτο click) για να "ξεμπλοκάρει" ήχους σε μερικούς browsers
document.addEventListener('click', function once() {
  try{
    // μικρό 'tap' sound για ξεκλείδωμα ήχων
    sfxCorrect.currentTime = 0;
    sfxCorrect.play().then(()=>{ sfxCorrect.pause(); sfxCorrect.currentTime = 0; }).catch(()=>{});
  } catch(e){}
  document.removeEventListener('click', once);
});

</script>
</body>
</html>
