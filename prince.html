<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î ÏÎ¯Î³ÎºÎ¹Ï€Î±Ï‚ Ï„Î·Ï‚ Î ÎµÏÏƒÎ¯Î±Ï‚ - Î ÎµÏÎ¹Ï€Î­Ï„ÎµÎ¹Î±</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2c1810 0%, #8b4513 50%, #daa520 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(180deg, #87ceeb 0%, #f4a460 70%, #8b4513 100%);
        }

        .game-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            color: white;
            font-size: 1.2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .game-canvas {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .player {
            position: absolute;
            width: 40px;
            height: 60px;
            z-index: 10;
        }

        .player-body {
            width: 100%;
            height: 100%;
            position: relative;
            animation: playerIdle 2s ease-in-out infinite;
        }

        .player-head {
            width: 18px;
            height: 20px;
            background: #fdbcb4;
            border-radius: 60% 40% 60% 40%;
            position: absolute;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            border: 2px solid #8b4513;
        }

        .player-head::before {
            content: 'ğŸ‘‘';
            position: absolute;
            top: -8px;
            left: 30%;
            transform: translateX(-50%);
            font-size: 0.8rem;
        }

        .player-head::after {
            content: 'ğŸ‘ï¸';
            position: absolute;
            top: 4px;
            right: 25%;
            transform: translateX(50%);
            font-size: 0.5rem;
            transition: right 0.2s ease;
        }

        .player[data-direction="left"] .player-head::after {
            right: 75%;
        }

        .player-body-torso {
            width: 22px;
            height: 20px;
            background: linear-gradient(145deg, #4169e1, #1e90ff);
            position: absolute;
            top: 25px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 8px 4px 4px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            transition: transform 0.2s ease;
        }

        .player[data-direction="left"] .player-body-torso {
            border-radius: 4px 8px 8px 4px;
        }

        .player-legs {
            width: 20px;
            height: 15px;
            background: #8b4513;
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 0 0 4px 4px;
        }

        .player-leg-left, .player-leg-right {
            width: 7px;
            height: 15px;
            background: #8b4513;
            position: absolute;
            top: 45px;
            border-radius: 0 0 4px 4px;
        }

        .player-leg-left {
            left: 10px;
            transform-origin: top center;
        }

        .player-leg-right {
            right: 12px;
            transform-origin: top center;
        }

        .player-arms {
            width: 30px;
            height: 8px;
            background: #fdbcb4;
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 4px;
        }

        .player-arm-left, .player-arm-right {
            width: 10px;
            height: 5px;
            background: #fdbcb4;
            position: absolute;
            top: 30px;
            border-radius: 3px;
            transition: left 0.2s ease, right 0.2s ease;
        }

        .player-arm-left {
            left: 6px;
            transform-origin: right center;
        }

        .player-arm-right {
            right: 10px;
            transform-origin: left center;
        }

        .player[data-direction="left"] .player-arm-left {
            left: 14px;
        }

        .player[data-direction="left"] .player-arm-right {
            right: 18px;
        }

        .player[data-direction="left"] .player-body {
            transform: scaleX(-1);
        }

        @keyframes playerIdle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-2px); }
        }

        .player.moving .player-body {
            animation: playerWalk 0.6s ease-in-out infinite;
        }

        @keyframes playerWalk {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-1px) rotate(-2deg); }
            75% { transform: translateY(-1px) rotate(2deg); }
        }

        .player.moving .player-leg-left {
            animation: playerLegLeft 0.6s ease-in-out infinite;
        }

        .player.moving .player-leg-right {
            animation: playerLegRight 0.6s ease-in-out infinite;
        }

        .player.moving .player-arm-left {
            animation: playerArmLeft 0.6s ease-in-out infinite;
        }

        .player.moving .player-arm-right {
            animation: playerArmRight 0.6s ease-in-out infinite;
        }

        @keyframes playerLegLeft {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(15deg); }
        }

        @keyframes playerLegRight {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }

        @keyframes playerArmLeft {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-20deg); }
        }

        @keyframes playerArmRight {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(20deg); }
        }

        .player.jumping .player-body {
            animation: playerJump 0.8s ease-out;
        }

        .player.jumping .player-arm-left {
            animation: playerJumpArmLeft 0.8s ease-out;
        }

        .player.jumping .player-arm-right {
            animation: playerJumpArmRight 0.8s ease-out;
        }

        @keyframes playerJump {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(-10deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }

        @keyframes playerJumpArmLeft {
            0% { transform: rotate(0deg); }
            30% { transform: rotate(-60deg); }
            70% { transform: rotate(-60deg); }
            100% { transform: rotate(0deg); }
        }

        @keyframes playerJumpArmRight {
            0% { transform: rotate(0deg); }
            30% { transform: rotate(-60deg); }
            70% { transform: rotate(-60deg); }
            100% { transform: rotate(0deg); }
        }

        .enemy {
            position: absolute;
            width: 35px;
            height: 50px;
            z-index: 5;
        }

        .enemy-body {
            width: 100%;
            height: 100%;
            position: relative;
            animation: enemyIdle 1.5s ease-in-out infinite;
        }

        .enemy-head {
            width: 16px;
            height: 18px;
            background: #8b0000;
            border-radius: 60% 40% 60% 40%;
            position: absolute;
            top: 3px;
            left: 50%;
            transform: translateX(-50%);
            border: 2px solid #654321;
        }

        .enemy-head::before {
            content: 'ğŸ‘¹';
            position: absolute;
            top: -2px;
            left: 30%;
            transform: translateX(-50%);
            font-size: 0.6rem;
        }

        .enemy-head::after {
            content: 'ğŸ‘ï¸';
            position: absolute;
            top: 3px;
            right: 25%;
            transform: translateX(50%);
            font-size: 0.4rem;
            transition: right 0.2s ease;
        }

        .enemy[data-direction="left"] .enemy-head::after {
            right: 75%;
        }

        .enemy-body-torso {
            width: 20px;
            height: 18px;
            background: linear-gradient(145deg, #8b0000, #654321);
            position: absolute;
            top: 21px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 8px 4px 4px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .enemy-legs {
            width: 18px;
            height: 12px;
            background: #2f2f2f;
            position: absolute;
            top: 38px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 0 0 4px 4px;
        }

        .enemy-leg-left, .enemy-leg-right {
            width: 6px;
            height: 12px;
            background: #2f2f2f;
            position: absolute;
            top: 38px;
            border-radius: 0 0 3px 3px;
        }

        .enemy-leg-left {
            left: 9px;
            transform-origin: top center;
        }

        .enemy-leg-right {
            right: 9px;
            transform-origin: top center;
        }

        .enemy-arms {
            width: 26px;
            height: 6px;
            background: #8b0000;
            position: absolute;
            top: 26px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 3px;
        }

        .enemy-arm-left, .enemy-arm-right {
            width: 9px;
            height: 4px;
            background: #8b0000;
            position: absolute;
            top: 26px;
            border-radius: 2px;
            transition: left 0.2s ease, right 0.2s ease;
        }

        .enemy-arm-left {
            left: 5px;
            transform-origin: right center;
        }

        .enemy-arm-right {
            right: 8px;
            transform-origin: left center;
        }

        .enemy[data-direction="left"] .enemy-arm-left {
            left: 12px;
        }

        .enemy[data-direction="left"] .enemy-arm-right {
            right: 15px;
        }

        .enemy[data-direction="left"] .enemy-body {
            transform: scaleX(-1);
        }

        @keyframes enemyIdle {
            0%, 100% { transform: translateY(0px) scaleX(1); }
            50% { transform: translateY(-1px) scaleX(1.05); }
        }

        .enemy.moving .enemy-body {
            animation: enemyWalk 0.8s ease-in-out infinite;
        }

        @keyframes enemyWalk {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-1px) rotate(-3deg); }
            75% { transform: translateY(-1px) rotate(3deg); }
        }

        .enemy.moving .enemy-leg-left {
            animation: enemyLegLeft 0.8s ease-in-out infinite;
        }

        .enemy.moving .enemy-leg-right {
            animation: enemyLegRight 0.8s ease-in-out infinite;
        }

        .enemy.moving .enemy-arm-left {
            animation: enemyArmLeft 0.8s ease-in-out infinite;
        }

        .enemy.moving .enemy-arm-right {
            animation: enemyArmRight 0.8s ease-in-out infinite;
        }

        @keyframes enemyLegLeft {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(20deg); }
        }

        @keyframes enemyLegRight {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-20deg); }
        }

        @keyframes enemyArmLeft {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-25deg); }
        }

        @keyframes enemyArmRight {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(25deg); }
        }

        .platform {
            position: absolute;
            background: linear-gradient(145deg, #8b4513, #654321);
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .platform::after {
            content: '';
            position: absolute;
            top: -2px;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #daa520, #b8860b);
            border-radius: 2px;
        }

        .treasure {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #ffd700, #ffb347);
            border-radius: 50%;
            z-index: 5;
            animation: sparkle 2s infinite;
        }

        .treasure::before {
            content: 'ğŸ’';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
        }

        @keyframes sparkle {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }

        .spike {
            position: absolute;
            width: 40px;
            height: 20px;
            background: linear-gradient(145deg, #696969, #2f2f2f);
            z-index: 5;
        }

        .spike::before {
            content: 'âš¡';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1rem;
            color: #ff4444;
        }

        .door {
            position: absolute;
            width: 50px;
            height: 80px;
            background: linear-gradient(145deg, #8b4513, #654321);
            border-radius: 8px 8px 0 0;
            z-index: 5;
        }

        .door::before {
            content: 'ğŸšª';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            font-size: 0.9rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
            display: none;
        }

        .restart-btn {
            background: linear-gradient(145deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .level-complete {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,100,0,0.9);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-ui">
            <div>Î•Ï€Î¯Ï€ÎµÎ´Î¿: <span id="level">1</span></div>
            <div>Î–Ï‰Î­Ï‚: <span id="lives">3</span> â¤ï¸</div>
            <div>Î˜Î·ÏƒÎ±Ï…ÏÎ¿Î¯: <span id="treasures">0</span> ğŸ’</div>
            <div>Î£ÎºÎ¿Ï: <span id="score">0</span></div>
        </div>

        <div class="game-canvas" id="gameCanvas">
            <!-- ÎŸ Ï€Î±Î¯ÎºÏ„Î·Ï‚ ÎºÎ±Î¹ Ï„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î¸Î± Ï€ÏÎ¿ÏƒÏ„ÎµÎ¸Î¿ÏÎ½ Î´Ï…Î½Î±Î¼Î¹ÎºÎ¬ -->
        </div>

        <div class="controls">
            <div>ğŸ® Î§ÎµÎ¹ÏÎ¹ÏƒÏ„Î®ÏÎ¹Î±:</div>
            <div>â† â†’ ÎšÎ¯Î½Î·ÏƒÎ· | â†‘ Î†Î»Î¼Î± | Spacebar Î•Ï€Î±Î½ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·</div>
        </div>

        <div class="game-over" id="gameOver">
            <h2>ğŸ’€ Î Î±Î¹Ï‡Î½Î¯Î´Î¹ Î¤ÎµÎ»ÎµÎ¯Ï‰ÏƒÎµ!</h2>
            <p>Î¤ÎµÎ»Î¹ÎºÏŒ Î£ÎºÎ¿Ï: <span id="finalScore">0</span></p>
            <button class="restart-btn" onclick="restartGame()">ğŸ”„ Î Î±Î¯Î¾Îµ ÎÎ±Î½Î¬</button>
        </div>

        <div class="level-complete" id="levelComplete">
            <h2>ğŸ‰ Î•Ï€Î¯Ï€ÎµÎ´Î¿ ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!</h2>
            <p>ÎœÏ€ÏŒÎ½Î¿Ï…Ï‚: <span id="levelBonus">0</span> Ï€ÏŒÎ½Ï„Î¿Î¹</p>
            <button class="restart-btn" onclick="nextLevel()">â¡ï¸ Î•Ï€ÏŒÎ¼ÎµÎ½Î¿ Î•Ï€Î¯Ï€ÎµÎ´Î¿</button>
        </div>
    </div>

    <script>
        class Game {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.player = null;
                this.platforms = [];
                this.enemies = [];
                this.treasures = [];
                this.spikes = [];
                this.door = null;
                
                this.level = 1;
                this.lives = 3;
                this.score = 0;
                this.treasureCount = 0;
                this.totalTreasures = 0;
                
                this.keys = {};
                this.gameRunning = true;
                
                this.gravity = 0.8;
                this.jumpPower = -15;
                this.moveSpeed = 5;
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.createLevel();
                this.gameLoop();
            }

            setupEventListeners() {
                document.addEventListener('keydown', (e) => {
                    this.keys[e.code] = true;
                    if (e.code === 'Space') {
                        e.preventDefault();
                        if (!this.gameRunning) {
                            this.restartGame();
                        }
                    }
                });

                document.addEventListener('keyup', (e) => {
                    this.keys[e.code] = false;
                });
            }

            createLevel() {
                this.canvas.innerHTML = '';
                this.platforms = [];
                this.enemies = [];
                this.treasures = [];
                this.spikes = [];
                
                // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î±Î¯ÎºÏ„Î·
                this.player = {
                    x: 50,
                    y: 400,
                    width: 40,
                    height: 60,
                    velocityX: 0,
                    velocityY: 0,
                    onGround: false,
                    element: this.createPlayer(50, 400),
                    isMoving: false,
                    isJumping: false
                };

                // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î»Î±Ï„Ï†Î¿ÏÎ¼ÏÎ½ Î²Î¬ÏƒÎµÎ¹ ÎµÏ€Î¹Ï€Î­Î´Î¿Ï…
                this.createPlatforms();
                this.createEnemies();
                this.createTreasures();
                this.createHazards();
                this.createDoor();
                
                this.updateUI();
            }

            createPlayer(x, y) {
                const playerElement = document.createElement('div');
                playerElement.className = 'player';
                playerElement.style.left = x + 'px';
                playerElement.style.top = y + 'px';
                playerElement.style.width = '40px';
                playerElement.style.height = '60px';
                
                playerElement.innerHTML = `
                    <div class="player-body">
                        <div class="player-head"></div>
                        <div class="player-arm-left"></div>
                        <div class="player-arm-right"></div>
                        <div class="player-body-torso"></div>
                        <div class="player-leg-left"></div>
                        <div class="player-leg-right"></div>
                    </div>
                `;
                
                this.canvas.appendChild(playerElement);
                return playerElement;
            }

            createEnemyElement(x, y) {
                const enemyElement = document.createElement('div');
                enemyElement.className = 'enemy';
                enemyElement.style.left = x + 'px';
                enemyElement.style.top = y + 'px';
                enemyElement.style.width = '35px';
                enemyElement.style.height = '50px';
                
                enemyElement.innerHTML = `
                    <div class="enemy-body">
                        <div class="enemy-head"></div>
                        <div class="enemy-arm-left"></div>
                        <div class="enemy-arm-right"></div>
                        <div class="enemy-body-torso"></div>
                        <div class="enemy-leg-left"></div>
                        <div class="enemy-leg-right"></div>
                    </div>
                `;
                
                this.canvas.appendChild(enemyElement);
                return enemyElement;
            }

            createPlatforms() {
                const platformData = [
                    // Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚
                    { x: 0, y: 500, width: 200, height: 20 },
                    { x: 300, y: 450, width: 150, height: 20 },
                    { x: 550, y: 400, width: 120, height: 20 },
                    { x: 750, y: 350, width: 150, height: 20 },
                    { x: 1000, y: 300, width: 200, height: 20 },
                    
                    // Î•Ï€Î¹Ï€Î»Î­Î¿Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚ Î³Î¹Î± Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ± ÎµÏ€Î¯Ï€ÎµÎ´Î±
                    { x: 200, y: 350, width: 80, height: 20 },
                    { x: 450, y: 250, width: 100, height: 20 },
                    { x: 650, y: 200, width: 120, height: 20 },
                    { x: 850, y: 150, width: 100, height: 20 },
                ];

                platformData.forEach(platform => {
                    if (platform.x < window.innerWidth) {
                        const element = this.createElement('div', 'platform', 
                            platform.x, platform.y, platform.width, platform.height);
                        this.platforms.push({
                            ...platform,
                            element
                        });
                    }
                });
            }

            createEnemies() {
                const enemyPositions = [
                    { x: 320, y: 400 },
                    { x: 570, y: 350 },
                    { x: 770, y: 300 },
                    { x: 1020, y: 250 }
                ];

                enemyPositions.forEach((pos, index) => {
                    if (index < this.level && pos.x < window.innerWidth - 100) {
                        const element = this.createEnemyElement(pos.x, pos.y);
                        this.enemies.push({
                            x: pos.x,
                            y: pos.y,
                            width: 35,
                            height: 50,
                            direction: 1,
                            speed: 1 + this.level * 0.5,
                            element,
                            isMoving: false
                        });
                    }
                });
            }

            createTreasures() {
                const treasurePositions = [
                    { x: 380, y: 410 },
                    { x: 600, y: 360 },
                    { x: 800, y: 310 },
                    { x: 1050, y: 260 },
                    { x: 480, y: 210 }
                ];

                this.totalTreasures = 0;
                treasurePositions.forEach((pos, index) => {
                    if (index < this.level + 2 && pos.x < window.innerWidth - 50) {
                        const element = this.createElement('div', 'treasure', pos.x, pos.y, 30, 30);
                        this.treasures.push({
                            x: pos.x,
                            y: pos.y,
                            width: 30,
                            height: 30,
                            collected: false,
                            element
                        });
                        this.totalTreasures++;
                    }
                });
            }

            createHazards() {
                const spikePositions = [
                    { x: 250, y: 480 },
                    { x: 500, y: 380 },
                    { x: 700, y: 330 }
                ];

                spikePositions.forEach((pos, index) => {
                    if (index < Math.floor(this.level / 2) && pos.x < window.innerWidth - 50) {
                        const element = this.createElement('div', 'spike', pos.x, pos.y, 40, 20);
                        this.spikes.push({
                            x: pos.x,
                            y: pos.y,
                            width: 40,
                            height: 20,
                            element
                        });
                    }
                });
            }

            createDoor() {
                const doorX = Math.min(1100, window.innerWidth - 100);
                this.door = {
                    x: doorX,
                    y: 220,
                    width: 50,
                    height: 80,
                    element: this.createElement('div', 'door', doorX, 220, 50, 80)
                };
            }

            createElement(tag, className, x, y, width, height) {
                const element = document.createElement(tag);
                element.className = className;
                element.style.left = x + 'px';
                element.style.top = y + 'px';
                element.style.width = width + 'px';
                element.style.height = height + 'px';
                this.canvas.appendChild(element);
                return element;
            }

            gameLoop() {
                if (!this.gameRunning) return;

                this.handleInput();
                this.updatePlayer();
                this.updateEnemies();
                this.checkCollisions();
                this.updateAnimations();
                this.updateUI();

                requestAnimationFrame(() => this.gameLoop());
            }

            handleInput() {
                const wasMoving = this.player.isMoving;
                this.player.isMoving = false;

                if (this.keys['ArrowLeft']) {
                    this.player.velocityX = -this.moveSpeed;
                    this.player.isMoving = true;
                    this.player.element.setAttribute('data-direction', 'left');
                } else if (this.keys['ArrowRight']) {
                    this.player.velocityX = this.moveSpeed;
                    this.player.isMoving = true;
                    this.player.element.setAttribute('data-direction', 'right');
                } else {
                    this.player.velocityX *= 0.8; // Î¤ÏÎ¹Î²Î®
                }

                if (this.keys['ArrowUp'] && this.player.onGround) {
                    this.player.velocityY = this.jumpPower;
                    this.player.onGround = false;
                    this.player.isJumping = true;
                }
            }

            updatePlayer() {
                // Î•Ï†Î±ÏÎ¼Î¿Î³Î® Î²Î±ÏÏÏ„Î·Ï„Î±Ï‚
                this.player.velocityY += this.gravity;

                // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î¸Î­ÏƒÎ·Ï‚
                this.player.x += this.player.velocityX;
                this.player.y += this.player.velocityY;

                // ÎŒÏÎ¹Î± Î¿Î¸ÏŒÎ½Î·Ï‚
                this.player.x = Math.max(0, Math.min(window.innerWidth - this.player.width, this.player.x));

                // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Ï€Ï„ÏÏƒÎ·Ï‚
                if (this.player.y > window.innerHeight) {
                    this.loseLife();
                }

                // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï… DOM
                this.player.element.style.left = this.player.x + 'px';
                this.player.element.style.top = this.player.y + 'px';
            }

            updateEnemies() {
                this.enemies.forEach(enemy => {
                    const oldX = enemy.x;
                    enemy.x += enemy.direction * enemy.speed;
                    
                    // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ ÎºÎ¹Î½ÎµÎ¯Ï„Î±Î¹
                    enemy.isMoving = Math.abs(enemy.x - oldX) > 0.1;
                    
                    // Î‘Î½Ï„Î¹ÏƒÏ„ÏÎ¿Ï†Î® ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ ÏƒÏ„Î± Î¬ÎºÏÎ± Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±Ï‚
                    const platform = this.platforms.find(p => 
                        enemy.x >= p.x - 50 && enemy.x <= p.x + p.width + 50 &&
                        Math.abs(enemy.y + enemy.height - p.y) < 30
                    );
                    
                    if (platform) {
                        if (enemy.x <= platform.x || enemy.x >= platform.x + platform.width - enemy.width) {
                            enemy.direction *= -1;
                        }
                    }

                    // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ·Ï‚ Î²Î»Î­Î¼Î¼Î±Ï„Î¿Ï‚
                    if (enemy.direction < 0) {
                        enemy.element.setAttribute('data-direction', 'left');
                    } else {
                        enemy.element.setAttribute('data-direction', 'right');
                    }

                    enemy.element.style.left = enemy.x + 'px';
                });
            }

            updateAnimations() {
                // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· animation Ï€Î±Î¯ÎºÏ„Î·
                if (this.player.isJumping && this.player.onGround) {
                    this.player.isJumping = false;
                }

                if (this.player.isJumping) {
                    this.player.element.className = 'player jumping';
                } else if (this.player.isMoving) {
                    this.player.element.className = 'player moving';
                } else {
                    this.player.element.className = 'player';
                }

                // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· animation ÎµÏ‡Î¸ÏÏÎ½
                this.enemies.forEach(enemy => {
                    if (enemy.isMoving) {
                        enemy.element.className = 'enemy moving';
                    } else {
                        enemy.element.className = 'enemy';
                    }
                });
            }

            checkCollisions() {
                this.player.onGround = false;

                // Î£ÏÎ³ÎºÏÎ¿Ï…ÏƒÎ· Î¼Îµ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼ÎµÏ‚
                this.platforms.forEach(platform => {
                    if (this.isColliding(this.player, platform)) {
                        if (this.player.velocityY > 0 && 
                            this.player.y < platform.y - this.player.height + 20) {
                            this.player.y = platform.y - this.player.height;
                            this.player.velocityY = 0;
                            this.player.onGround = true;
                        }
                    }
                });

                // Î£ÏÎ³ÎºÏÎ¿Ï…ÏƒÎ· Î¼Îµ ÎµÏ‡Î¸ÏÎ¿ÏÏ‚
                this.enemies.forEach(enemy => {
                    if (this.isColliding(this.player, enemy)) {
                        this.loseLife();
                    }
                });

                // Î£ÏÎ³ÎºÏÎ¿Ï…ÏƒÎ· Î¼Îµ Î±Î³ÎºÎ¬Î¸Î¹Î±
                this.spikes.forEach(spike => {
                    if (this.isColliding(this.player, spike)) {
                        this.loseLife();
                    }
                });

                // Î£Ï…Î»Î»Î¿Î³Î® Î¸Î·ÏƒÎ±Ï…ÏÏÎ½
                this.treasures.forEach(treasure => {
                    if (!treasure.collected && this.isColliding(this.player, treasure)) {
                        treasure.collected = true;
                        treasure.element.style.display = 'none';
                        this.treasureCount++;
                        this.score += 100;
                    }
                });

                // Î£ÏÎ³ÎºÏÎ¿Ï…ÏƒÎ· Î¼Îµ Ï€ÏŒÏÏ„Î±
                if (this.door && this.isColliding(this.player, this.door)) {
                    if (this.treasureCount >= this.totalTreasures) {
                        this.completeLevel();
                    }
                }
            }

            isColliding(rect1, rect2) {
                return rect1.x < rect2.x + rect2.width &&
                       rect1.x + rect1.width > rect2.x &&
                       rect1.y < rect2.y + rect2.height &&
                       rect1.y + rect1.height > rect2.y;
            }

            loseLife() {
                this.lives--;
                if (this.lives <= 0) {
                    this.gameOver();
                } else {
                    // Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ Ï€Î±Î¯ÎºÏ„Î· ÏƒÏ„Î·Î½ Î±ÏÏ‡Î®
                    this.player.x = 50;
                    this.player.y = 400;
                    this.player.velocityX = 0;
                    this.player.velocityY = 0;
                }
            }

            completeLevel() {
                this.gameRunning = false;
                const bonus = this.lives * 500 + (this.totalTreasures - this.treasureCount) * 100;
                this.score += bonus;
                
                document.getElementById('levelBonus').textContent = bonus;
                document.getElementById('levelComplete').style.display = 'block';
            }

            gameOver() {
                this.gameRunning = false;
                document.getElementById('finalScore').textContent = this.score;
                document.getElementById('gameOver').style.display = 'block';
            }

            updateUI() {
                document.getElementById('level').textContent = this.level;
                document.getElementById('lives').textContent = this.lives;
                document.getElementById('treasures').textContent = `${this.treasureCount}/${this.totalTreasures}`;
                document.getElementById('score').textContent = this.score;
            }

            nextLevel() {
                this.level++;
                this.treasureCount = 0;
                this.gameRunning = true;
                document.getElementById('levelComplete').style.display = 'none';
                this.createLevel();
                this.gameLoop();
            }

            restartGame() {
                this.level = 1;
                this.lives = 3;
                this.score = 0;
                this.treasureCount = 0;
                this.gameRunning = true;
                
                document.getElementById('gameOver').style.display = 'none';
                document.getElementById('levelComplete').style.display = 'none';
                
                this.createLevel();
                this.gameLoop();
            }
        }

        // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î±Î¹Ï‡Î½Î¹Î´Î¹Î¿Ï
        let game = new Game();

        // Î£Ï…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î± ÎºÎ¿Ï…Î¼Ï€Î¹Î¬
        function restartGame() {
            game.restartGame();
        }

        function nextLevel() {
            game.nextLevel();
        }

        // Î‘Ï€Î¿Ï„ÏÎ¿Ï€Î® scroll Î¼Îµ Ï„Î± Î²Î­Î»Î·
        window.addEventListener('keydown', function(e) {
            if(['Space','ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].indexOf(e.code) > -1) {
                e.preventDefault();
            }
        }, false);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987c406ff69f3c3d',t:'MTc1OTMyNDc2Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
